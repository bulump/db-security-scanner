{% extends "base.html" %}

{% block title %}New Scan - Database Security Scanner{% endblock %}

{% block content %}
<div class="scan-form-container">
    <div class="intro-section">
        <h2>Run a Security Scan</h2>
        <p>Connect to your PostgreSQL database and run a comprehensive security analysis using AI-powered agents.</p>

        <div class="features">
            <div class="feature">
                <span class="icon">ðŸ¤–</span>
                <h3>AI Analysis</h3>
                <p>Three specialized AI agents analyze your database</p>
            </div>
            <div class="feature">
                <span class="icon">ðŸŽ¯</span>
                <h3>CIS Compliance</h3>
                <p>Validates against PostgreSQL 16 Benchmark v1.1</p>
            </div>
            <div class="feature">
                <span class="icon">ðŸ“Š</span>
                <h3>Detailed Reports</h3>
                <p>Comprehensive findings with remediation steps</p>
            </div>
        </div>
    </div>

    <form id="scanForm" class="scan-form">
        <h3>Database Connection</h3>

        <div class="form-row">
            <div class="form-group">
                <label for="host">Host</label>
                <input type="text" id="host" name="host" value="localhost" required>
            </div>

            <div class="form-group">
                <label for="port">Port</label>
                <input type="number" id="port" name="port" value="5432" required>
            </div>
        </div>

        <div class="form-group">
            <label for="database">Database Name *</label>
            <input type="text" id="database" name="database" placeholder="mydb" required>
        </div>

        <div class="form-group">
            <label for="user">Username *</label>
            <input type="text" id="user" name="user" placeholder="postgres" required>
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password" name="password" placeholder="Optional">
            <small>Leave blank if no password is required</small>
        </div>

        <div class="form-group">
            <label for="compliance_framework">Compliance Framework</label>
            <select id="compliance_framework" name="compliance_framework">
                <option value="CIS" selected>CIS PostgreSQL 16 Benchmark v1.1</option>
                <option value="STIG">DISA STIG</option>
                <option value="SOC2">SOC 2</option>
                <option value="HIPAA">HIPAA</option>
                <option value="PCI-DSS">PCI-DSS</option>
            </select>
        </div>

        <button type="submit" class="btn-primary" id="scanButton">
            <span class="btn-text">Run Security Scan</span>
            <span class="btn-loader" style="display: none;">
                <span class="spinner"></span> Scanning...
            </span>
        </button>

        <div id="scanError" class="error-message" style="display: none;"></div>
    </form>

    <div id="scanProgress" class="scan-progress" style="display: none;">
        <h3>Scan in Progress</h3>
        <div class="progress-steps">
            <div class="step active">
                <span class="step-icon">ðŸ”Œ</span>
                <p>Connecting to database</p>
            </div>
            <div class="step">
                <span class="step-icon">ðŸ“Š</span>
                <p>Gathering configuration</p>
            </div>
            <div class="step">
                <span class="step-icon">ðŸ¤–</span>
                <p>Running AI analysis</p>
            </div>
            <div class="step">
                <span class="step-icon">ðŸ“„</span>
                <p>Generating report</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
